<html> <head> <title>Leibniz formula for pi</title></head><body>:''See [[Leibniz formula]] for other formulas known under the same name.''

In [[mathematics]], the '''Leibniz formula for [[Pi|&pi;]]''', named after [[Gottfried Leibniz]], states that

:<math>1 \,-\, \frac{1}{3} \,+\, \frac{1}{5} \,-\, \frac{1}{7} \,+\, \frac{1}{9} \,-\, \cdots \;=\; \frac{\pi}{4}.\!</math>

Using [[summation]] notation:

:<math>\sum_{n=0}^\infty \, \frac{(-1)^n}{2n+1} \;=\; \frac{\pi}{4}.\!</math>

==Names==
The [[infinite series]] above is called the '''Leibniz series'''. It is also called the '''[[Gregory's series|Gregory&ndash;Leibniz series]]''', recognizing the work of [[James Gregory (astronomer and mathematician)|James Gregory]].  The formula may have been discovered by [[Madhava of Sangamagrama]]<ref>{{citation|title=Special Functions|last=George E. Andrews, Richard Askey|first=Ranjan Roy|publisher=[[Cambridge University Press]]|year=1999|isbn=0521789885|page=58}}</ref> and so is sometimes called the '''[[Madhava series|Madhava&ndash;Leibniz series]]'''.<ref>{{citation|first=R. C.|last=Gupta|title=On the remainder term in the Madhava&ndash;Leibniz's series|journal=Ganita Bharati|volume=14|issue=1-4|year=1992|pages=68–71}}</ref>

==Proof==
:<math>\frac{\pi}{4}  \;=\;\arctan(1)\;=\;\int_0^1 \frac 1{1+x^2}dx</math>
:<math>=\int_0^1\left(\sum_{k=0}^n (-1)^k x^{2k}+\frac{(-1)^{n+1}\,x^{2n+2} }{1+x^2}\right)dx</math>
:<math>=\sum_{k=0}^n \frac{(-1)^k}{2k+1}
+(-1)^{n+1}\int_0^1\frac{x^{2n+2}}{1+x^2}dx.</math>
As ''n''&rarr;∞ the sum becomes the Leibniz series and the integral converges to zero because
:<math>\int_0^1 \frac{x^{2n+2}}{1+x^2}\,dx \;<\; \int_0^1 x^{2n+2}\,dx \;=\; \frac{1}{2n+3} \;\rightarrow\; 0 .\!</math>
This proves the Leibniz formula
:<math>\frac{\pi}4\;=\;\sum_{k=0}^\infty\frac{(-1)^k}{2k+1}.</math>

== Inefficiency == 

Leibniz's formula converges slowly. Calculating π to 10 ''correct'' decimal places using direct summation of the series requires about 5,000,000,000 terms because <math>\scriptstyle \frac 1{2k+1}<10^{-10}</math> for <math>\scriptstyle k>\frac{10^{10}-1}2</math>.

However, the Leibniz formula can be used to calculate π to high precision (hundreds of digits or more) using various [[convergence acceleration]] techniques. For example, the [[Shanks transformation]], [[Euler transform]] or [[Van Wijngaarden transformation]], which are general methods for alternating series, can be applied effectively to the partial sums of the Leibniz series. Further, combining terms pairwise gives the non-alternating series

:<math>\frac{\pi}{4} = \sum_{n=0}^{\infty} \frac{1}{4n+1}-\frac{1}{4n+3} = \sum_{n=0}^{\infty} \frac{2}{(4n+1)(4n+3)}</math>

which can be evaluated to high precision from a small number of terms using [[Richardson extrapolation]] or the [[Euler-Maclaurin summation formula]]. This series can also be transformed into an integral by means of the [[Abel-Plana formula]] and evaluated using techniques for [[numerical integration]].

== Unusual Behavior ==
If the series is truncated at the right time, the [[Decimal representation|decimal expansion]] of the approximation will agree with that of π for many more digits, except for isolated digits or digit groups. For example, taking  5,000,000 terms yields

:3.141592<u>4</u>5358979323846<u>4</u>643383279502<u>7</u>841971693993<u>873</u>058...

where the underlined digits are wrong. The errors can in fact be predicted; they are generated by the [[Euler number]]s ''E<sub>n</sub>'' according to the [[asymptotic expansion|asymptotic]] formula

:<math>\frac{\pi}{2} - 2 \sum_{k=1}^{N/2} \frac{(-1)^{k-1}}{2k-1} \sim \sum_{m=0}^{\infty} \frac{E_{2m}}{N^{2m+1}}\!</math>

where ''N'' is an integer divisible by 4. If ''N'' is chosen to be a power of ten, each term in the right sum becomes a finite decimal fraction. The formula is a special case of the [[Boole summation formula]] for alternating series, providing yet another example of a convergence acceleration technique that can be applied to the Leibniz series. In 1992, [[Jonathan Borwein]] and [[Mark Limber]] used the first thousand Euler numbers to calculate π to 5,263 decimal places with Leibniz' formula. 

==References==
* Jonathan Borwein, David Bailey & Roland Girgensohn, ''Experimentation in Mathematics - Computational Paths to Discovery'', A K Peters 2003, ISBN 1-56881-136-5, pages 28&ndash;30.
{{reflist}}

==External links==
* [http://mattst88.com/programming/?page=leibniz Leibniz Formula in C, x86 FPU Assembly, x86-64 SSE3 Assembly, and DEC Alpha Assembly]

[[Category:Calculus]]
[[Category:Pi algorithms]]
[[Category:Articles containing proofs]]

[[da:Leibniz' række]]
[[de:Leibniz-Reihe]]
[[es:Serie de Leibniz]]
[[fr:Formule de Leibniz]]
[[it:Formula di Leibniz per pi]]
[[ja:ライプニッツの公式]]
[[ru:Ряд Лейбница]]
[[zh:Π的莱布尼茨公式]]</body> </html>