<html> <head> <title>Windows File Protection</title></head><body>'''Windows File Protection''' (WFP), a sub-system included in [[Microsoft Windows]] [[operating system]]s of the [[Windows 2000]] and [[Windows XP]] era, aims to prevent programs from replacing critical Windows [[system file]]s. Protecting core system files mitigates problems such as [[DLL hell]] with programs and the operating system. Windows 2000, [[Windows XP]] and [[Windows Server 2003]] include WFP under the name of ''Windows File Protection''; [[Windows Me]] includes it as ''System File Protection''.

== Operation ==
With Windows File Protection active, replacing or deleting a system file that has no [[File locking|file lock]] to prevent it getting overwritten causes Windows to immediately and silently restore the original copy of the file. The original version of the file is restored from a cached folder which contains backup copies of these files. The [[Windows NT]] family uses the cached folder <tt>%WinDir%\System32\Dllcache</tt>. [[Windows Me]] caches its entire set of compressed cabinet setup files and stores them in the <tt>%Systemroot%\Options\Install</tt> folder.

WFP covers all files which the operating system installs (such as <tt>DLL</tt>, <tt>EXE</tt>, <tt>SYS</tt>, <tt>OCX</tt> etc.),  protecting them from deletion or from replacement by older versions. The [[digital signature]]s of these files are checked using [[code signing]] and the signature catalog files stored in the <tt>%Systemroot%\system32\catRoot\{F750E6C3-38EE-11D1-85E5-00C04FC295EE}</tt> folder. Only certain operating system components such as the ''Package Installer'' (Update.exe) or [[Windows Installer]] (Msiexec.exe) can replace these files. Changes made using any other methods in order to replace these files are reverted and the files are silently restored from the cache. If Windows File Protection cannot automatically find the file in the cached folder, it searches the network path or prompts the user for the Windows installation disc to restore the appropriate version of the file.

WFP integrates with the [[System File Checker]] (<code>sfc.exe</code>) utility.

[[Windows Vista]] does not include Windows File Protection, but it includes [[Windows Resource Protection]] which protects files using [[Access control list|ACLs]]. Windows Resource Protection aims to protect core [[Windows registry|registry]] keys and values and prevent potentially damaging system configuration changes, besides operating system files.

Note that the non-use of ACLs in Windows File Protection was a design choice: Not only did it allow operation on non-NTFS systems, but it prevented those same "bad" installers from failing completely from a file access error.

== See also ==
* [[Windows Resource Protection]]
* [[System File Checker]]
* [[Access Control List]]
* [[Security Identifier]]

== External links ==
* [http://support.microsoft.com/kb/222193 Overview of Windows File Protection]
* [http://support.microsoft.com/kb/222473 Registry settings for Windows File Protection]
* [http://www.microsoft.com/whdc/archive/wfp.mspx Whitepaper on Windows File Protection]
* [http://support.microsoft.com/kb/253571 Overview of System File Protection (Windows Me)]
* [http://www.bitsum.com/aboutwfp.asp Hacking Windows File Protection]

{{Windows Components}}

[[Category:Microsoft Windows]]
[[Category:Windows administration]]
[[Category:Windows components]]
[[Category:Windows 2000]]

[[ru:Windows File Protection]]</body> </html>