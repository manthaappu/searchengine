<html> <head> <title>Furuta pendulum</title></head><body>{{Refimprove|date=July 2009}}[[Image:RotaryInvertedPendulum.JPG|thumb|right|150px| Rotational Inverted Pendulum: Classic pedagogical example of application of control theory]]
The Furuta pendulum, or rotational inverted pendulum, consists of a driven arm which rotates in the horizontal plane and a [[pendulum]] attached to that arm which is free to rotate in the vertical plane (Fig 1).  

== Overview ==
The '''Furuta pendulum''' was first developed at the [http://www.titech.ac.jp/ Tokyo Institute of Technology] by Katsuhisa Furuta <ref>Furuta, K., Yamakita, M. and Kobayashi, S. (1992) “Swing-up control of inverted pendulum using pseudo-state feedback”, Journal of Systems and Control Engineering, 206(6), 263-269.</ref><ref name="Xuetal2001">Xu, Y., Iwase, M. and Furuta, K. (2001) “Time optimal swing-up control of single pendulum”, Journal of Dynamic Systems, Measurement, and Control, 123(3), 518-527.</ref><ref name="Furutaetal2004">Furuta, K., Iwase, M. (2004) “Swing-up time analysis of pendulum”, Bulletin of the Polish Academy of Sciences: Technical Sciences, 52(3), 153-163.</ref><ref name="Iwaseetal2006">Iwase, M., Åström, K.J., Furuta, K. and Åkesson, J. (2006) “Analysis of safe manual control by using Furuta pendulum”, Proceedings of the IEEE International Conference on Control Applications, 568-572.</ref> and his colleagues.  The pendulum is [[Underactuation|underactutated]] and extremely [[Nonlinear|non-linear]] due to the gravitational forces and the coupling arising from the [[Coriolis effect|Coriolis]] and [[Centripetal force|centripetal]] forces.  Since then, dozens, possibly hundreds of papers and theses have used the system to demonstrate linear and non-linear control laws <ref>J.Á. Acosta, “Furuta's Pendulum: A Conservative Nonlinear Model for Theory and Practise,” Mathematical Problems in Engineering, vol. 2010, Article ID 742894, 29 pages. http://www.hindawi.com/journals/mpe/2010/742894.html</ref><ref name="Akessonetal2001">Åkesson, J. and Åström, K.J. (2001) “Safe Manual Control of the Furuta Pendulum”, In Proceedings 2001 IEEE International Conference on Control Applications (CCA'01),  pp. 890-895.</ref><ref>Olfati-Saber, R. (2001) “Nonlinear Control of Underactuated Mechanical Systems with Application to Robotics and Aerospace Vehicles”, PhD Thesis, Department of Electrical Engineering and Computer Science, Massachusetts Institute of Technology, Cambridge, MA. http://www.cds.caltech.edu/~olfati/thesis/ </ref>.  The system has also been the subject of two texts <ref name="Fantoni">Fantoni, I. and Lozano, R. (2002) “Non-linear control of underactuated mechanical systems”, Springer-Verlag, London.</ref><ref name="Egeland">Egeland, O. and Gravdahl, T. (2002) “Modeling and Simulation for Automatic Control”, Marine Cybernetics, Trondheim, Norway, 639 pp., ISBN 82-92356-00-2.</ref>.  

==Equations of motion==
Despite the great deal of attention the system has received, very few publications successfully derive (or use) the full dynamics.  Many authors <ref name="Furutaetal2004"/><ref name="Fantoni"/> have only considered the rotational inertia of the pendulum for a single principal axis (or neglected it altogether <ref name="Egeland"/>).  In other words, the inertia tensor only has a single non-zero element (or none), and the remaining two diagonal terms are zero. It is possible to find a pendulum system where the moment of inertia in one the three principal axes is approximately zero, but not two.

A few authors <ref name="Xuetal2001"/><ref name="Iwaseetal2006"/><ref name="Akessonetal2001"/><ref>Hirata, H., Haga, K., Anabuki, M., Ouchi, S. and Ratiroch-Anant, P.  (2006) “Self-Tuning Control for Rotation Type Inverted Pendulum Using Two Kinds of Adaptive Controllers”, Proceedings of the 2006 IEEE Conference on Robotics, Automation and Mechatronics, 1-6. http://lab8.ec.u-tokai.ac.jp/RAM062.pdf</ref><ref>Ratiroch-Anant, P., Anabuki, M. and Hirata, H. (2004) “Self-tuning control for rotational inverted pendulum by eigenvalue approach”, Proceedings of TENCON 2004, IEEE Region 10 Conference, Volume D, 542-545. http://lab8.ec.u-tokai.ac.jp/TENCON2004_D-542.pdf</ref><ref>Baba, Y., Izutsu, M., Pan, Y. And Furuta, K. (2006) “Design of control method to rotate pendulum”, Proceedings of SICE-ICASE International Joint Conference, Korea.</ref> have considered slender symmetric pendulums where the moments of inertia for two of the principal axes are equal and the remaining moment of inertia is zero.  Of the dozens of publications surveyed for this wiki only a single conference paper <ref>Craig, K. and Awtar, S. (2005) “Inverted pendulum systems: rotary and arm-driven a mechatronic system design case study”, Proceedings of the 7th Mechatronics Forum International Conference, Atlanta. http://www-personal.umich.edu/~awtar/craig_awtar_1.pdf</ref> and journal paper <ref>Awtar, S., King, N., Allen, T., Bang, I., Hagan, M., Skidmore, D. and Craig, K. (2002) “Inverted pendulum systems: Rotary and arm-driven – A mechatronic system design case study”, Mechatronics, 12, 357-370. http://www-personal.umich.edu/~awtar/invertedpendulum_mechatronics.pdf</ref> were found to include all three principal inertial terms of the pendulum.  Both papers used a [[Lagrangian mechanics|Lagrangian formulation]] but each contained minor errors (presumably typographical).  

The equations of motion presented here are an extract from a [http://www.mecheng.adelaide.edu.au/robotics_novell/projects/2004/Pendulum/Furuta_Pedulum_Internal_report.pdf paper]<ref name="Cazzolatoetal2008">Cazzolato, B.S and Prime, Z (2008) "The Dynamics of the Furuta Pendulum", Technical Report, The University of Adelaide. http://www.mecheng.adelaide.edu.au/robotics_novell/projects/2004/Pendulum/Furuta_Pedulum_Internal_report.pdf</ref> on the Furuta pendulum dynamics derived at the [http://www.adelaide.edu.au University of Adelaide].

===Definitions===

[[Image:Furuta pendulum.jpg|thumb|450px| Fig. 1: Schematic of the single rotary inverted pendulum system.]]

Consider the rotational inverted pendulum mounted to a DC motor as shown in Fig. 1.  The DC motor is used to apply a torque <math>\tau_1</math> to Arm 1.  The link between Arm 1 and Arm 2 is not actuated but free to rotate.  The two arms have lengths  <math>L_1</math>  and  <math>L_2</math>.  The arms have masses  <math>m_1</math> and  <math>m_2</math> which are located at <math>l_1</math>  and <math>l_2</math>  respectively, which are the lengths from the point of rotation of the arm to its center of mass.  The arms have inertia tensors  <math>\boldsymbol{J}_1</math> and <math>\boldsymbol{J}_2</math> (about the centre of mass of the arm).  Each rotational joint is viscously damped with damping coefficients  <math>b_1</math> and  <math>b_2</math>, where  <math>b_1</math> is the damping provided by the motor bearings and  <math>b_2</math> is the damping arising from the pin coupling between Arm 1 and Arm 2. 

A right hand coordinate system has been used to define the inputs, states and the Cartesian coordinate systems 1 and 2.  The coordinate axes of Arm 1 and Arm 2 are the principal axes such that the inertia tensors are diagonal.

The angular rotation of Arm 1, <math>\theta_1</math>, is measured in the horizontal plane where a counter-clockwise direction (when viewed from above) is positive.  The angular rotation of Arm 2, <math>\theta_2</math> , is measured in the vertical plane where a counter-clockwise direction (when viewed from the front) is positive.  When the Arm is hanging down in the stable equilibrium position <math>\theta_2=0</math> . 

The torque the servo-motor applies to Arm 1, <math>\tau_1</math>, is positive in a counter-clockwise direction (when viewed from above).  A disturbance torque,  <math>\tau_2</math>, is experienced by Arm 2, where a counter-clockwise direction (when viewed from the front) is positive.

===Assumptions===
Before deriving the dynamics of the system a number of assumptions must be made.  These are:
*The motor shaft and Arm 1 are assumed to be rigidly coupled and infinitely stiff.
*Arm 2 is assumed to be infinitely stiff.
*The coordinate axes of Arm1 and Arm 2 are the principal axes such that the inertia tensors are diagonal.
*The motor rotor inertia is assumed to be negligible.  However, this term may be easily added to the moment of inertia of Arm 1.
*Only viscous damping is considered.  All other forms of damping (such as Coulomb) have been neglected, however it is a simple exercise to add this to the final governing DE.

===Non-linear Equations of Motion===
The non-linear equations of motion are given by <ref name="Cazzolatoetal2008"/>

<math>\ddot{\theta}_1 \left(J_{1zz} + m_1 l_1^2 + m_2 L_1^2 + (J_{2yy} + m_2 l_2^2)\sin^2(\theta_2) +
J_{2xx}\cos^2(\theta_2) \right) 
+ \ddot{\theta}_2 m_2 L_1 l_2 \cos(\theta_2) 
- m_2 L_1 l_2 \sin(\theta_2) \dot{\theta}_2^2 
+\dot{\theta}_1 \dot{\theta}_2 \sin(2 \theta_2) (m_2 l_2^2 + J_{2yy} - J_{2xx}) 
+b_1 \dot{\theta}_1
= \tau_1</math>

and

<math>\ddot{\theta}_1 m_2 L_1 l_2 \cos(\theta_2)
+\ddot{\theta}_2 (m_2 l_2^2 + J_{2zz})
+ 1/2 \dot{\theta}_1^2 \sin(2 \theta_2) ( -m_2 l_2^2 - J_{2yy} + J_{2xx} )
+b_2 \dot{\theta}_2
+g m_2 l_2 \sin(\theta_2)
= \tau_2</math>

===Simplifications===
Most Furuta pendulums tend to have long slender arms, such that the moment of
inertia along the axis of the arms is negligible. In addition, most arms have
rotational symmetry such that the moments of inertia in two of the principal axes
are equal. Thus, the inertia tensors may be approximated as follows:

<math>\boldsymbol{J}_1 = diag[J_{1xx},J_{1yy},J_{1zz}] = diag[0,J_{1},J_{1}]</math>

<math>\boldsymbol{J}_2 = diag[J_{2xx},J_{2yy},J_{2zz}] = diag[0,J_{2},J_{2}]</math>

Further simplifications are obtained by making the following substitutions. The
total moment of inertia of Arm 1 about the pivot point (using the parallel axis
theorem) is <math>\hat{J_1} = J_1 +m_1l_1^2</math>. The total moment of inertia of Arm 2 about its pivot
point is <math>\hat{J_2} = J_2 +m_2l_2^2</math>. Finally, define the total moment of inertia the motor
rotor experiences when the pendulum (Arm 2) is in its equilibrium position
(hanging vertically down), <math>\hat{J_0} = \hat{J}_1 +m_2L_1^2 =  J_1 +m_1l_1^2 + m_2L_1^2 </math>.

Substituting the previous definitions into the governing DEs gives the more
compact form

<math>\ddot{\theta}_1 \left(\hat{J_0} + \hat{J_2}\sin^2(\theta_2) \right) 
+ \ddot{\theta}_2 m_2 L_1 l_2 \cos(\theta_2) 
- m_2 L_1 l_2 \sin(\theta_2) \dot{\theta}_2^2 
+\dot{\theta}_1 \dot{\theta}_2 \sin(2 \theta_2)\hat{J_2} 
+b_1 \dot{\theta}_1
= \tau_1</math>

and

<math>\ddot{\theta}_1 m_2 L_1 l_2 \cos(\theta_2)
+\ddot{\theta}_2 \hat{J_2}
- 1/2 \dot{\theta}_1^2 \sin(2 \theta_2) \hat{J_2} 
+b_2 \dot{\theta}_2
+g m_2 l_2 \sin(\theta_2)
= \tau_2</math>

==See also==
*[[Inverted pendulum]]
*[[Double inverted pendulum]]
*[[Inertia wheel pendulum]]

==References==
<references/> 

== Further reading ==
* [http://www.mecheng.adelaide.edu.au/robotics_novell/projects/2004/Pendulum/Furuta_Pedulum_Internal_report.pdf The Dynamics of the Furuta Pendulum]
* [http://downloads.hindawi.com/journals/mpe/2010/742894.pdf Furuta's Pendulum: A Conservative Nonlinear Model for Theory and Practise]

==External links==
* [http://www.mecheng.adelaide.edu.au/robotics/robotics_projects.php?wpage_id=44&title=24&ebrowsebytitle=1 The University of Adelaide]
* [http://www.control.utoronto.ca/people/profs/bortoff/pendulum.html University of Toronto]
* [http://www.ece.osu.edu/~passino/rip.html Ohio State University]

{{DEFAULTSORT:Furuta Pendulum}}
[[Category:Pendulums]]
[[Category:Control engineering]]</body> </html>