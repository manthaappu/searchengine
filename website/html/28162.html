<html> <head> <title>PQ tree</title></head><body>A '''PQ tree''' is a tree-based [[data structure]] that represents a family of [[permutation]]s on a set of elements, discovered and named by [[Kellogg S. Booth]] and [[George S. Lueker]] in 1976. It is a rooted, labeled tree, in which each element is represented by one of the [[leaf node]]s, and each non-leaf node is labelled P or Q. A P node has at least two children, and a Q node has at least three children.

A PQ tree represents its permutations via permissible reorderings of the children of its nodes. The children of a P node may be reordered in any way. The children of a Q node may be put in reverse order, but may not otherwise be reordered. A PQ tree represents all leaf node orderings that can be achieved by any sequence of these two operations. A PQ tree with many P and Q nodes can represent complicated subsets of the set of all possible orderings. However, not every set of orderings may be representable in this way; for instance, if an ordering is represented by a PQ tree, the reverse of the ordering must also be represented by the same tree.

PQ trees are used to solve problems where the goal is to find an ordering that satisfies various constraints. In these problems, constraints on the ordering are included one at a time, by modifying the PQ tree structure in such a way that it represents only orderings satisfying the constraint.  Applications of PQ trees include creating a contig map from [[DNA]] fragments, testing a matrix for the consecutive ones property, recognizing [[interval graph]]s and determining whether a graph is [[Planar graph|planar]].

==Examples and notation==
[[Image:pq-tree-5-leaves.png|left|thumb|The PQ tree representing 
<br/>[1 (2 3 4) 5] ]]

If all the leaves of a PQ tree are connected directly to a root P node then all possible orderings are allowed. If all the leaves are connected directly to a root Q node then only one order (and its reverse) is allowed. If nodes a,b,c connect to a P node, which connects to a root P node, with all other leaf nodes connected directly to the root, then any ordering where a,b,c are contiguous is allowed.

Where graphical presentation is unavailable PQ trees are often noted using nested parenthesized lists.  Square parentheses represents a Q node and regular ones represents P nodes.  Leaves are non-parentheses elements of the lists.  The image on the left is represented in this notation by [1 (2 3 4) 5]. This PQ tree represents the following twelve permutations on the set {1, 2, 3, 4, 5}:
: 12345, 12435, 13245, 13425, 14235, 14325, 52341, 52431, 53241, 53421, 54231, 54321.

==PC trees==

The '''PC tree''', developed by [[Wei-Kuan Shih]] and [[Wen-Lian Hsu]], is a more recent generalization of the PQ tree. Like the PQ tree it represents permutations by reorderings of nodes in a tree, with elements represented at the leaves of the tree. Unlike the PQ tree, the PC tree is unrooted. The nodes adjacent to any non-leaf node labeled P may be reordered arbitrarily as in the PQ tree, while the nodes adjacent to any non-leaf node labeled C have a fixed [[cyclic order]] and may only be reordered by reversing this order.  Thus, a PC tree can only represent sets of orderings in which any circular permutation or reversal of an ordering in the set is also in the set. However, a PQ tree on ''n'' elements may be simulated by a PC tree on ''n'' + 1 elements, where the extra element serves to root the PC tree.  The data structure operations required to perform a planarity testing algorithm on PC trees are somewhat simpler than the corresponding operations on PQ trees.

==See also==
*[[Series-parallel partial order]]

==References==
* {{cite journal
  | author = Booth, Kellogg S. and Lueker, George S.
  | title = Testing for the consecutive ones property, interval graphs, and graph planarity using PQ-tree algorithms
  | journal = [[Journal of Computer and System Sciences]]
  | volume = 13
  | pages = 335–379
  | year = 1976}}
* {{cite journal
  | author = Shih, Wei-Kuan and Hsu, Wen-Lian
  | title = A new planarity test
  | url = http://www.iis.sinica.edu.tw/IASL/webpdf/paper-1999-A_New_Planarity_test.pdf
  | journal = [[Theoretical Computer Science (journal)|Theoretical Computer Science]]
  | volume = 223
  | pages = 179–191
  | year = 1999
  | doi = 10.1016/S0304-3975(98)00120-0}}

==External links==
*[http://knol.google.com/k/greg-grothaus/pq-trees-and-the-consecutive-ones/2zbou4xzp3j9w/4 PQ Trees and the Consecutive Ones Property]* 

{{CS-Trees}}

{{DEFAULTSORT:Pq Tree}}
[[Category:Trees (structure)]]

[[ru:PQ-дерево]]</body> </html>