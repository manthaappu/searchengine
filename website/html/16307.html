<html> <head> <title>Harmonic balance</title></head><body>'''Harmonic balance''' is a method used to calculate the [[Steady state (electronics)|steady-state response]] of electrical circuits
<ref>{{cite journal
 |last = Gilmore |first=R. J. |coauthors=Steer, M. B. |title=Nonlinear circuit analysis using the method of harmonic balance—A review of the art. Part I. Introductory concepts |journal=Int. J. Microw. Mill.-Wave Comput.-Aided Eng.
|volume=1 |pages=22&ndash;37 |year=1991 |doi=10.1002/mmce.4570010104}}</ref>
.<ref>{{cite journal
  | last = Nakhla
  | first = Michel S. 
  | authorlink = 
  | coauthors = Vlach, Jiri
  | title = A piecewise harmonic balance technique for determination of periodic response of nonlinear systems
  | journal = IEEE Transactions on Circuits and Systems,
  | volume = CAS-23
  | pages = 85–91
  | date = February 1976
  | issn = 0098-4094
  | accessdate = 2009-08-21 }}
</ref> It is a ''frequency domain'' method for calculating the steady state, as opposed to the various ''time-domain'' steady state methods.  The name "harmonic balance" is descriptive of the method, which starts with Kirchoff's Current Law written in the frequency domain and a chosen number of harmonics. Effectively the method assumes the solution can be represented by a linear combination of sinusoids, then balances current and voltage sinusoids to satisfy Kirchoff's law. The method is commonly used to simulate circuits which include [[nonlinear]] elements.<ref>{{cite book
  | last = Maas
  | first = Stephen A.
  | title = Nonlinear microwave and RF circuits
  | publisher = Artech House
  | year = 2003
  | isbn = 1-58053-484-8 }}</ref>

Microwave circuits were the original application for harmonic balance methods in electrical engineering. Microwave circuits were well-suited because, historically, microwave circuits consist of many linear components which can be directly represented in the frequency domain, plus a few nonlinear components.  System sizes were typically small. For more general circuits, the method was considered impractical for all but these very small circuits until the mid-1990s, when Krylov subspace methods were applied to the problem.<ref>{{cite journal 
|author=Feldmann, P.; Melville, B.; Long, D.
|title= Efficient frequency domain analysis of large nonlinear analog circuits
|journal=Proceedings of the Custom Integrated Circuits Conference
|year=1996 
|pages=461&ndash;464
|doi = 10.1109/CICC.1996.510597}}</ref><ref>{{cite journal
|author=Brachtendorf, H.G.; Welsch, G.; Laur, R.
|title=Fast simulation of the steady-state of circuits by the harmonic balance technique
|journal=Proceedings, International Symposium on Circuits and Systems
|pages=1388
|year=1995
|doi=10.1109/ISCAS.1995.520406}}</ref> 
The application of preconditioned Krylov subspace methods allowed much larger systems to be solved, both in size of circuit and in numbers of harmonics. This made practical the present-day use of harmonic balance methods to analyze radio-frequency integrated circuits (RFICs).

==Algorithm==

The algorithm starts with Kirchoff's current law written in the [[frequency-domain]]. To increase the efficiency of the procedure, the circuit may be partitioned into its linear and nonlinear parts, since the linear part is readily described and calculated using [[nodal analysis]] directly in the frequency domain. 

First, an initial guess is made for the solution, then an iterative process continues:

# Voltages <math>V</math> are used to calculate the currents of the linear part, <math>I_\mbox{linear}</math> in the frequency domain.
# Voltages <math>V</math> are then used to calculate the currents in the nonlinear part, <math>I_\mbox{nonlinear}</math>. Since nonlinear devices are described in the time domain, the frequency-domain voltages <math>V</math> are transformed into the time domain, typically using inverse fast Fourier transforms. The nonlinear devices are then evaluated using the time-domain voltage waveforms to produce their time-domain currents. The currents are then transformed back into the frequency domain.
# According to [[Kirchhoff's current law|Kirchhoff's circuit laws]], the sum of the currents must be zero, <math>\epsilon = I_\mbox{linear} + I_\mbox{nonlinear} = 0</math>. An iterative process, usually [[Newton iteration]], is used to update the network voltages <math>V</math> such that the current residual <math>\epsilon</math> is reduced. This step requires formulation of the [[Jacobian matrix and determinant|Jacobian]] <math>\tfrac{d\epsilon}{dV}</math>.

Convergence is reached when <math>\epsilon</math> is acceptably small, at which point all voltages and currents of the steady-state solution are known, most often represented as Fourier coefficients.

==References==
<references />

{{DEFAULTSORT:Harmonic Balance}}
[[Category:Electronic design]]
[[Category:Electronic circuits]]
[[Category:Electrical engineering]]</body> </html>