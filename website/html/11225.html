<html> <head> <title>Dynamic Language Runtime</title></head><body>{{Infobox Software
| name = Dynamic Language Runtime
| logo = 
| screenshot = 
| caption = 
| developer = [[Microsoft]] Dynamic Language Runtime Team
| latest release version = 1.0
| latest release date = April 16, 2010
| latest preview version = 
| latest preview date = 
| operating system = Microsoft Windows, [[Debian]], [[Ubuntu (operating system)|Ubuntu]]
| platform = [[Microsoft .NET|.NET]], [[Mono (software)|Mono]]
| genre = [[Platform (computing)|System platform]]
| license =  [[Apache License|Apache License, v2.0]]
| website = [http://dlr.codeplex.com dlr.codeplex.com]
}}

The '''Dynamic Language Runtime''' (DLR) from [[Microsoft]] is an ongoing effort to bring a set of services that run on top of the [[Common Language Runtime]] (CLR) and provides language services for several different [[dynamic language]]s. These services include:

* A dynamic [[type system]], to be shared by all languages utilizing the DLR services
* [[Dynamic dispatch|Dynamic method dispatch]]
* [[Runtime code generation|Dynamic code generation]]
* Hosting API

The DLR is used to implement dynamic languages like [[Python (programming language)|Python]] and [[Ruby (programming language)|Ruby]] on the [[.NET Framework]].

By having several dynamic language implementations share a common underlying system, it should be easier to let these implementations interact with one another. For example, it should be possible to use libraries from any dynamic language in any other dynamic language. In addition, the hosting API allows interoperability with statically typed [[list of CLI languages|CLI languages]] like [[C sharp (programming language)|C#]].

==History==
Microsoft's Dynamic Language Runtime project was announced by Microsoft at [[MIX (Microsoft)|MIX]] 2007.<ref name="announce" />  Microsoft planned to ship a first usable 1.0 version of the DLR at the same time as IronPython 2.0, by the end of 2008.<ref>{{cite web 
| url = http://lists.ironpython.com/pipermail/users-ironpython.com/2008-January/006235.html | title = Roadmap for IronPython 2.0
| last=Viehland |first=Dino
| quote=''We don't really have a document like this but the general goal is to ship IronPython 2.0 by the end of the year. For the DLR its self the plan is to ship a v1.0 around the same time as IronPython 2.0.''
| date = 2008-01-15
| accessdate = 2008-02-09}}</ref>

Microsoft shipped .NET DLR 0.9 beta on the 26 November 2008,<ref>http://www.codeplex.com/dlr</ref> and final 0.9 on 10 December 2008. Version 1.0 shipped on April 16, 2010. On 16 July 2010, Microsoft changed the license of the DLR from the  [[Shared source#Microsoft Public License (Ms-PL)|Microsoft Public License]] to the Apache License, v2.0.<ref>http://dlr.codeplex.com/license</ref>

==Supported languages==
The DLR services are currently used in the development version of [[IronRuby]], a .NET implementation of the Ruby language, and for [[IronPython]].<ref name="announce">{{cite web 
| url = http://blogs.msdn.com/hugunin/archive/2007/04/30/a-dynamic-language-runtime-dlr.aspx
|last=Hugunin|first=Jim
| title = A Dynamic Language Runtime (DLR)
|quote=''For the short term, our focus is on using a small number of languages to drive the first wave of DLR development where we can work closely and face-to-face with the developers in order to iron out the worst kinks in the DLR design. After this initial phase, we want to reach out to the broader language community.''
| accessdate = 2007-06-21 }}</ref>

In 2007, Microsoft planned to use the DLR for the upcoming [[Visual Basic .NET#Visual Basic 2010 (VB 10.0)|Visual Basic 2010 (VB 10.0)]] and [[JScript|Managed JScript]] ([[ECMAScript]] 3.0).<ref name="Managed JScript announced">{{cite web 
| url = http://blogs.msdn.com/jscript/archive/2007/05/04/managed-jscript-announced.aspx
| title =  Managed JScript announced
| accessdate = 2007-05-04}}</ref><ref name="Managed JScript announced"/><ref>{{cite web 
| url = http://www.panopticoncentral.net/archive/2007/05/01/20383.aspx
| title = What the heck is "VBx"?
| date=2007-05-01
| quote=''With the new DLR, we have support for IronPython, IronRuby, Javascript, and the new dynamic VBx compile''
| accessdate = 2009-08-12}}</ref><ref>{{cite web 
| url = http://www.hanselman.com/blog/PuttingMixSilverlightTheCoreCLRAndTheDLRIntoContext.aspx
| title =  Putting Mix, Silverlight, the CoreCLR and the DLR into context
| date=2007-05-01
| accessdate = 2008-08-12}}</ref><ref>{{cite web 
| url = http://www.infoq.com/news/2007/05/VBx
| title = Introducing Visual Basic 10 
| publisher=infoq.com
| date=2007-05-04
| quote=''VB 10 takes advantage of a Silverlight feature called the Dynamic Language Runtime or DLR''
| accessdate = 2009-08-12}}</ref> However, as of August 2009, Microsoft has no more plans to implement [[JScript|Managed JScript]] ([[ECMAScript]] 3.0) on the DLR,<ref>{{cite web 
| url = http://dlr.codeplex.com/Thread/View.aspx?ThreadId=58121
|last=Chiles|first=Bill
| title =  Future of Managed JScript (IronJScript)? 
|quote=''The DLR JScript was experimental for informing the design of the DLR (expression trees, interop, callsites, hosting, etc.).  The JS we released with asp futures and the Silverlight dynamic sdk became very old and unserviceable as the DLR continued evolving for release in CLR 4.0.  Unfortunately, there are no plans at this time to develop and release a DLR-hostable JScript.''
| date=2009-06-01
| accessdate = 2009-08-12}}</ref> and no further mention of [[Visual Basic .NET]] working on the DLR has been made by Microsoft on Visual Basic development updates. Similar to [[C Sharp (programming language)|C#]], Visual Basic will be able to access objects from dynamic languages built on the DLR such as [[IronPython]] and [[IronRuby]].<ref>{{cite web 
| url = http://msdn.microsoft.com/en-us/library/we86c8x2%28VS.100%29.aspx
| title = What's New in Visual Basic 2010
| year=2009
| publisher=[[Microsoft]]
| quote=''Visual Basic binds to objects from dynamic languages such as IronPython and IronRuby''
| accessdate = 2009-08-12}}</ref>

[[IronScheme]], an upcoming [[Scheme (programming language)|Scheme]] implementation,<ref>http://www.codeplex.com/IronScheme</ref> was planning to build upon the DLR. This idea was abandoned because the DLR [[Branching (software)|branch]] the project used became out of sync with the [[Trunk (software)|trunk]], and also because (according to the project coordinator) the current version of the DLR at that time could not support the majority of Scheme's requirements.<ref>{{cite web 
| url = http://ironscheme.codeplex.com/Thread/View.aspx?ThreadId=55925
| title = Is there any silverlight sample?    
|quote=''Unfortunately, my DLR branch is very out of sync with the Silverlight one. I just thought about it, perhaps I do not need the DLR perse, will investigate. The problem is that the DLR as-is, is not good enough to support the majority of the Scheme's requirements''
| date=2009-05-11
| accessdate = 2009-07-26}}</ref>

==Architecture==
The Dynamic Language Runtime is built on the idea that it is possible to implement language specificities on top of a generic language-agnostic [[abstract syntax tree]], whose nodes correspond to a specific functionality that is common to many dynamic languages.<ref>{{cite web 
| url = http://blogs.msdn.com/hugunin/archive/2007/05/15/dlr-trees-part-1.aspx
| title = DLR Trees (Part 1)
| last=Hugunin|first=Jim
| quote=''The key implementation trick in the DLR is using these kinds of trees to pass code around as data and to keep code in an easily analyzable and mutable form as long as possible.''
| date = 2007-05-15
| accessdate = 2008-02-23}}</ref> This architecture is backed by the idea that the number of elementary language constructs that would have to be implemented on the generic stack should be inherently limited.<ref>{{cite web 
| url = http://headius.blogspot.com/2008/01/langnet-2008-day-1-thoughts.html
| title = Lang.NET 2008: Day 1 Thoughts
| last=Nutter|first=Charles
| quote=''The idea is that there's a quickly-flattening asymptotic curve to the number of expression tree nodes required to implement each new language. Whether that's the case is yet to be seen.''
| date = 2008-01-28
| accessdate = 2008-02-23}}</ref> The DLR [[.NET metadata#Reflection|dynamically generates]] code corresponding to the functionality expressed by these nodes. The compiler for any dynamic language implemented on top of the DLR has to generate DLR abstract trees, and hand it over to the DLR libraries. 

The DLR provides dynamically-updated <code>DynamicSite</code> objects that cache the task of binding methods to objects. Since the type of an object—as well as the members it contains—in dynamic languages can change during a program lifetime, a method invocation must check the method list to see if the invocation is a valid one. <code>DynamicSite</code> objects represent and cache the state of the object and its methods; any update to the object is reflected in the <code>DynamicSite</code> objects as well. DLR routes all method invocations via the <code>DynamicSite</code> objects, which then performs a fast lookup and [[name binding|binding]] of the method with the actual implementation.<ref>{{cite web | url = http://msdn2.microsoft.com/en-us/magazine/cc163344.aspx | title = CLR Inside Out: IronPython and the Dynamic Language Runtime | publisher = [[MSDN]] Magazine | author = Bill Chiles | date = October 2007 | accessdate = 2007-08-10}}</ref>

In contrast to other efforts like the [[Parrot virtual machine]] (with no dependencies) or [[Da Vinci Machine]] (built on Java's [[JVM]] by adding new bytecodes in the [[Java bytecode|JVM instruction set]]), the DLR is built on top of the existing [[Common Language Runtime]], the [[.NET Framework]] virtual machine.<ref>{{cite web 
| url = http://blogs.sun.com/jrose/entry/bravo_for_the_dynamic_runtime
| title = Bravo for the dynamic runtime!
| last=Rose|first=John
| quote=''The differences between the CLR and JVM extensions are interesting to note. They work completely above the level of the CLR without significantly enhancing it, while we are developing the JVM and libraries at the same time.''
| date = 2008-02-02
| accessdate = 2008-02-23}}</ref>

==See also==
*[[Da Vinci Machine]], an ongoing effort to bring support for dynamic languages on the [[Java Platform]] at the [[Java Virtual Machine]] level.

== References ==
{{reflist|2}}

{{refbegin}}
*{{cite web | url = http://blogs.msdn.com/somasegar/archive/2007/04/30/mix-07-silverlight-shines-brighter.aspx | title = MIX 07 - Silverlight shines brighter! | accessdate = 2007-04-30}}
*{{cite web | url = http://sessions.visitmix.com/default.asp?event=1011&session=2012&pid=DEV02&disc=&id=1511&year=2007&search=DEV02 | title = MIX 07 Video Presentation - DEV02 - Just Glue It! Ruby and the DLR in Silverlight | accessdate = 2007-05-04 |archiveurl = http://web.archive.org/web/20070508035633/http://sessions.visitmix.com/default.asp?event=1011&session=2012&pid=DEV02&disc=&id=1511&year=2007&search=DEV02 <!-- Bot retrieved archive --> |archivedate = 2007-05-08}}
*{{cite web | url = http://blogs.msdn.com/hugunin/archive/2007/04/30/a-dynamic-language-runtime-dlr.aspx | title = Jim Hugunin's Thinking Dynamic | A Dynamic language runtime (DLR) | accessdate = 2008-02-06}}
*{{cite web | url = http://packages.debian.org/source/squeeze/dlr-languages | title = Details of source package dlr-languages in squeeze | DLR in Debian | accessdate = 2010-07-06}}
*{{cite web | url = http://packages.ubuntu.com/source/lucid/dlr-languages | title = Details of source package dlr-languages in lucid | DLR in Ubuntu | accessdate = 2010-07-06}}
{{refend}}

{{DotNET}}

[[Category:Microsoft application programming interfaces]]
[[Category:.NET framework]]

[[fr:Dynamic Language Runtime]]
[[ja:動的言語ランタイム]]
[[pl:Dynamic Language Runtime]]
[[sv:Dynamic Language Runtime]]
[[zh:Dynamic Language Runtime]]</body> </html>