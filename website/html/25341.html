<html> <head> <title>Multinomial theorem</title></head><body>In [[mathematics]], the '''multinomial theorem''' says how to write a [[power (mathematics)|power]] of a sum in terms of powers of the terms in that sum. It is the generalization of the [[binomial theorem]] to polynomials.

==Theorem==
For any positive integer ''m'' and any nonnegative integer ''n'', the multinomial formula tells us how a polynomial expands when raised to an arbitrary power:

:<math>(x_1 + x_2  + \cdots + x_m)^n 
 = \sum_{k_1+k_2+\cdots+k_m=n} {n \choose k_1, k_2, \ldots, k_m}
  \prod_{1\le t\le m}x_{t}^{k_{t}}\,.</math>

The summation is taken over all sequences of nonnegative integer indices ''k''<sub>1</sub> through ''k''<sub>m</sub> such the sum of all ''k''<sub>i</sub> is ''n''.  That is, for each term in the expansion, the exponents must add up to ''n''.  Also, as with the [[binomial theorem]], quantities of the form ''x''<sup>0</sup> that appear are taken to equal 1 (even when ''x'' equals zero). Alternatively, this can be written concisely using [[multiindices]] as

:<math>(x_1+\cdots+x_m)^n = \sum_{|\alpha|=n}{n \choose \alpha}x^\alpha</math>

where α = (α<sub>1</sub>,α<sub>2</sub>,…,α<sub>m</sub>) and x<sup>α</sup> = ''x''<sub>1</sub><sup>α<sub>1</sub></sup>''x''<sub>2</sub><sup>α<sub>2</sub></sup>⋯''x''<sub>''m''</sub><sup>α<sub>''m''</sub></sup>.

====Number of multinomial coefficients====
The number of terms in multinomial sum, #<sub>''n'',''m''</sub>, is equal to the number of monomials of degree ''n'' on the variables ''x''<sub>1</sub>, …, ''x''<sub>''m''</sub>:
:<math>
\#_{n,m} = {n+m-1 \choose m-1} = {n+m-1 \choose n}\,.
</math>

===Multinomial coefficients===
The numbers
:<math> {n \choose k_1, k_2, \ldots, k_m}
 = \frac{n!}{k_1!\, k_2! \cdots k_m!}</math>  

(which can also be written as:)
:<math>
 = {k_1\choose k_1}{k_1+k_2\choose k_2}\cdots{k_1+k_2+\cdots+k_m\choose k_m}
 = \prod_{i=1}^m {\sum_{j=1}^i k_j \choose k_i}</math>

are the '''multinomial coefficients'''. Just like "n choose k" are the coefficients when you raise a ''binomial'' to the ''n''<sup>th</sup> power (e.g. the coefficients are 1,3,3,1 for (''a'' + ''b'')<sup>3</sup>, where ''n'' = 3), the multinomial coefficients appear when one raises a ''multinomial'' to the ''n''<sup>th</sup> power (e.g. (''a'' + ''b'' + ''c'')<sup>3</sup>)

====Sum of all multinomial coefficients====
The substitution of ''x''<sub>''i''</sub> = 1 for all ''i'' into:
:<math>\sum_{k_1+k_2+\cdots+k_m=n} {n \choose k_1, k_2, \ldots, k_m} x_1^{k_1} x_2^{k_2} \cdots x_m^{k_m}
= (x_1 + x_2  + \cdots + x_m)^n\,,</math>
gives immediately that 
:<math>
\sum_{k_1+k_2+\cdots+k_m=n} {n \choose k_1, k_2, \ldots, k_m} = m^n\,.
</math>

====Central multinomial coefficients====
All of the multinomial coefficients for which the following holds true:

:<math>
\sum_{i=1}^m{k_i} = n,\ \left\lfloor\frac{n}{m}\right\rfloor \le k_i \le \left\lceil\frac{n}{m}\right\rceil,
</math>

are '''central multinomial coefficients''': the greatest ones and all of equal size.

A special case for ''m'' = 2 is [[central binomial coefficient]].

===Example multinomial coefficients===
:<math>(a+b+c)^3 = a^3 + b^3 + c^3 + 3 a^2 b + 3 a^2 c + 3 b^2 a + 3 b^2 c + 3 c^2 a + 3 c^2 b + 6 a b c.</math>

We could have calculated each coefficient by first expanding (''a'' + ''b'' + ''c'')<sup>2</sup> = ''a''<sup>2</sup> + ''b''<sup>2</sup> + ''c''<sup>2</sup> + 2''ab'' + 2''bc'' + 2''ac'', then self-multiplying it again to get (''a'' + ''b'' + ''c'')<sup>3</sup> (and then if we were raising it to higher powers, we'd multiply it by itself even some more). However this process is slow, and can be avoided by using the multinomial theorem. The multinomial theorem "solves" this process by giving us the closed form for any coefficient we might want. It is possible to "read off" the multinomial coefficients from the terms by using the multinomial coefficient formula. For example:

:<math>a^2 b^0 c^1 </math> has the coefficient <math>{3 \choose 2, 0, 1} = \frac{3!}{2!\cdot 0!\cdot 1!} = \frac{6}{2 \cdot 1 \cdot 1} = 3</math>
:<math>a^1 b^1 c^1</math> has the coefficient <math>{3 \choose 1, 1, 1} = \frac{3!}{1!\cdot 1!\cdot 1!} = \frac{6}{1 \cdot 1 \cdot 1} = 6</math>.

We could have also had a 'd' variable, or even more variables—hence the ''multinomial'' theorem.

The [[binomial theorem]] and [[binomial coefficient]]s are special cases, for ''m'' = 2, of the multinomial theorem and multinomial coefficients, respectively.

==Interpretations==
===Ways to put objects into sized boxes===
The multinomial coefficients have a direct combinatorial interpretation, as the number of ways of depositing ''n'' distinct objects into ''m'' distinct bins, with ''k''<sub>1</sub> objects in the first bin, ''k''<sub>2</sub> objects in the second bin, and so on.<ref>{{cite web |url=http://dlmf.nist.gov/ |title=NIST Digital Library of Mathematical Functions |author=[[National Institute of Standards and Technology]] |date=May, 11, 2010 |at=[http://dlmf.nist.gov/26.4 Section 26.4] |accessdate=August 30, 2010}}</ref>

===Number of ways to select according to a distribution===
In [[statistical mechanics]] and [[combinatorics]] if one has a number distribution of labels then the multinomial coefficients naturally arise from the binomial coefficients. Given a number distribution  {''n''<sub>''i''</sub>} on a set of ''N'' total items, ''n''<sub>''i''</sub> represents the number of items to be given the label ''i''.  (In statistical mechanics ''i'' is the label of the energy state.)  

The number of arrangements is found by 
*Choosing ''n''<sub>1</sub> of the total ''N'' to be labeled 1.  This can be done <math>N\choose n_1</math> ways.
*From the remaining ''N'' − ''n''<sub>1</sub> items choose ''n''<sub>2</sub> to label 2.  This can be done <math>N-n_1 \choose n_2</math> ways.
*From the remaining ''N'' − ''n''<sub>1</sub> − ''n''<sub>2</sub> items choose ''n''<sub>3</sub> to label 3.  Again, this can be done <math>N-n_1-n_2 \choose n_3</math> ways.

Multiplying the number of choices at each step results in:
:<math>{N \choose n_1}{N-n_1\choose n_2}{N-n_1-n_2\choose n_3}...=\frac{N!}{(N-n_1)!n_1!}\frac{(N-n_1)!}{(N-n_1-n_2)!n_2!}\frac{(N-n_1-n_2)!}{(N-n_1-n_2-n_3)!n_3!}....</math>

Upon cancellation, we arrive at the formula given in the introduction.

===Number of unique permutations of words===
In addition, the multinomial coefficient is also the number of distinct ways to [[permutation|permute]] a [[multiset]] of ''n'' elements, and ''k<sub>i</sub>'' are the [[Multiplicity (mathematics)|multiplicities]] of each of the distinct elements. For example, the number of distinct permutations of the letters of the word MISSISSIPPI, which has 1 M, 4 Is, 4 Ss, and 2 Ps is
:<math>{11 \choose 1, 4, 4, 2} = \frac{11!}{1!\, 4!\, 4!\, 2!} = 34650.</math>

(This is just like saying that there are 11! ways to permute the letters—the common interpretation of [[factorial]] as the number of unique permutations. However, we counted extra due to the fact that some letters are the same, and must divide to correct our answer.)

===Generalized Pascal's triangle===
One can use the multinomial theorem to generalize Pascal's triangle to [[Pascal's pyramid]] or [[Pascal's simplex]]. This provides a quick way to generate a lookup table for multinomial coefficients.

The case of ''n'' = 3 can be easily drawn by hand. The case of ''n'' = 4 can be drawn with effort as a series of growing pyramids.

==Proof==
This proof of the multinomial theorem uses the [[binomial theorem]] and [[Mathematical induction|induction]] on ''m''. 

First, for ''m'' = 1, both sides equal ''x''<sub>1</sub><sup>''n''</sup> since there is only one term ''k''<sub>1</sub> = ''n'' in the sum. For the induction step, suppose the multinomial theorem holds for ''m''.  Then
:<math>(x_1+x_2+\cdots+x_m+x_{m+1})^n = (x_1+x_2+\cdots+(x_m+x_{m+1}))^n </math>
:<math>   = \sum_{k_1+k_2+\cdots+k_{m-1}+K=n}{n\choose k_1,k_2,\ldots,k_{m-1},K} x_1^{k_1}x_2^{k_2}\cdots x_{m-1}^{k_{m-1}}(x_m+x_{m+1})^K
</math>
by the induction hypothesis.  Applying the binomial theorem to the last factor,
:<math> = \sum_{k_1+k_2+\cdots+k_{m-1}+K=n}{n\choose k_1,k_2,\ldots,k_{m-1},K} x_1^{k_1}x_2^{k_2}\cdots x_{m-1}^{k_{m-1}}\sum_{k_m+k_{m+1}=K}{K\choose k_m,k_{m+1}}x_m^{k_m}x_{m+1}^{k_{m+1}}</math>
:<math> = \sum_{k_1+k_2+\cdots+k_{m-1}+k_m+k_{m+1}=n}{n\choose k_1,k_2,\ldots,k_{m-1},k_m,k_{m+1}} x_1^{k_1}x_2^{k_2}\cdots x_{m-1}^{k_{m-1}}x_m^{k_m}x_{m+1}^{k_{m+1}}
</math>
which completes the induction.  The last step follows because
:<math>{n\choose k_1,k_2,\ldots,k_{m-1},K}{K\choose k_m,k_{m+1}} = {n\choose k_1,k_2,\ldots,k_{m-1},k_m,k_{m+1}},</math>
as can easily be seen by writing the three coefficients using factorials as follows:

:<math> \frac{n!}{k_1! k_2! \cdots k_{m-1}!K!} \frac{K!}{k_m! k_{m+1}!}=\frac{n!}{k_1! k_2! \cdots k_{m+1}!}.</math>

==See also==
* [[Multinomial distribution]]

==References==
{{Reflist}}

{{DEFAULTSORT:Multinomial Theorem}}
[[Category:Algebra]]
[[Category:Factorial and binomial topics]]
[[Category:Articles containing proofs]]
[[Category:Mathematical theorems]]

[[ca:Teorema multinomial]]
[[cs:Multinomická věta]]
[[de:Multinomialtheorem]]
[[fr:Formule du multinôme de Newton]]
[[it:Coefficiente multinomiale]]
[[pt:Teorema multinomial]]
[[ru:Мультиномиальный коэффициент]]
[[sv:Multinomialsatsen]]
[[uk:Мультиноміальний коефіцієнт]]
[[ur:متعدد رقمی مسلئہ اثباتی]]</body> </html>